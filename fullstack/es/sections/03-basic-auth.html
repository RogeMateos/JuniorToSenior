<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTTP: Basic Auth | FullStack</title>
    <link rel="stylesheet" href="../../../assets/css/styles.css">
</head>
<body>
    <div class="container">
        <main class="main-content">
            <section id="section-basic-auth">
                <h1>üîê HTTP: Basic Auth</h1>
                <p><strong>Mental model fundamental para entender autenticaci√≥n moderna</strong></p>

                <h2>1Ô∏è‚É£ ¬øQu√© problema estamos resolviendo?</h2>

                <p>Cuando un cliente (browser, Postman, app m√≥vil, frontend React, etc.) hace una petici√≥n HTTP:</p>
                <pre><code>GET /api/data</code></pre>

                <p>El servidor necesita responder una pregunta:</p>
                <p>üëâ <strong>¬øQui√©n eres y tienes permiso para acceder?</strong></p>

                <p>Aqu√≠ entra Basic Authentication.</p>

                <h2>2Ô∏è‚É£ Qu√© es HTTP Basic Auth</h2>

                <p>Basic Auth es uno de los mecanismos m√°s antiguos de autenticaci√≥n en HTTP.</p>

                <p>Funciona as√≠:</p>
                <ul>
                    <li>El cliente env√≠a un header llamado Authorization</li>
                    <li>Dentro env√≠a: username:password codificado en Base64</li>
                    <li>El servidor lo decodifica</li>
                    <li>Valida credenciales</li>
                    <li>Responde 200 (OK) o 401/403</li>
                </ul>

                <h2>3Ô∏è‚É£ Formato exacto del Header</h2>

                <p>El formato es:</p>
                <pre><code>Authorization: Basic base64(username:password)</code></pre>

                <p><strong>Ejemplo:</strong></p>
                <p>Usuario: <code>admin</code></p>
                <p>Password: <code>secret</code></p>

                <p>Se combinan: <code>admin:secret</code></p>

                <p>Se codifica en Base64: <code>YWRtaW46c2VjcmV0</code></p>

                <p>Header final:</p>
                <pre><code>Authorization: Basic YWRtaW46c2VjcmV0</code></pre>

                <p>‚ö†Ô∏è <strong>Importante:</strong> Base64 NO es cifrado, es solo encoding. Cualquiera puede decodificarlo. Por eso Basic Auth solo es seguro sobre HTTPS.</p>

                <h2>4Ô∏è‚É£ Flujo completo paso a paso</h2>

                <p><strong>Paso 1 ‚Äî Cliente hace request sin credenciales</strong></p>
                <pre><code>GET /api</code></pre>

                <p>Servidor responde:</p>
                <pre><code>401 Unauthorized
WWW-Authenticate: Basic realm="staging"</code></pre>

                <p>Esto le dice al cliente: "Necesitas autenticaci√≥n tipo Basic"</p>

                <p><strong>Paso 2 ‚Äî Cliente env√≠a Authorization header</strong></p>
                <pre><code>GET /api
Authorization: Basic YWRtaW46c2VjcmV0</code></pre>

                <p><strong>Paso 3 ‚Äî Servidor valida</strong></p>
                <p>El servidor:</p>
                <ul>
                    <li>Lee req.headers.authorization</li>
                    <li>Divide por espacio</li>
                    <li>Extrae Base64</li>
                    <li>Decodifica</li>
                    <li>Separa username/password</li>
                    <li>Valida</li>
                </ul>

                <h2>5Ô∏è‚É£ Implementaci√≥n real en Node (sin Express)</h2>

                <p><strong>Este ejemplo te ense√±a el mecanismo real HTTP.</strong></p>

                <pre><code>import http from "node:http";

function unauthorized(res) {
  res.statusCode = 401;
  res.setHeader("WWW-Authenticate", 'Basic realm="staging"');
  res.end("Unauthorized");
}

function forbidden(res) {
  res.statusCode = 403;
  res.end("Forbidden");
}

function parseBasicAuth(authHeader) {
  const [scheme, encoded] = authHeader.split(" ");

  if (scheme !== "Basic" || !encoded) return null;

  const decoded = Buffer.from(encoded, "base64").toString("utf8");

  const separatorIndex = decoded.indexOf(":");
  if (separatorIndex === -1) return null;

  const username = decoded.slice(0, separatorIndex);
  const password = decoded.slice(separatorIndex + 1);

  return { username, password };
}

const server = http.createServer((req, res) => {
  const auth = req.headers.authorization;

  if (!auth) return unauthorized(res);

  const creds = parseBasicAuth(auth);
  if (!creds) return unauthorized(res);

  if (creds.username !== "admin") return unauthorized(res);

  if (creds.password !== "secret") return forbidden(res);

  res.statusCode = 200;
  res.end("Authenticated successfully");
});

server.listen(3000, () => {
  console.log("Server running on http://localhost:3000");
});</code></pre>

                <h2>6Ô∏è‚É£ Diferencia clave: 401 vs 403</h2>

                <p><strong>Esto es pregunta t√≠pica de entrevista.</strong></p>

                <table class="cheat-sheet-table">
                    <thead>
                        <tr>
                            <th>C√≥digo</th>
                            <th>Significado</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>401</td>
                            <td>No est√°s autenticado</td>
                        </tr>
                        <tr>
                            <td>403</td>
                            <td>Est√°s autenticado pero no autorizado</td>
                        </tr>
                    </tbody>
                </table>

                <p>En sistemas reales muchas veces se usa 401 para credenciales inv√°lidas y 403 cuando el usuario existe pero no tiene permisos.</p>

                <h2>7Ô∏è‚É£ C√≥mo probarlo</h2>

                <p><strong>En el navegador</strong></p>
                <p>Si el servidor devuelve:</p>
                <pre><code>WWW-Authenticate: Basic realm="staging"</code></pre>

                <p>El navegador muestra popup autom√°ticamente.</p>

                <p><strong>En Postman</strong></p>
                <ul>
                    <li>Authorization ‚Üí Basic Auth</li>
                    <li>Username / Password</li>
                    <li>Postman genera el header autom√°ticamente</li>
                    <li>Puedes ver el header generado en la pesta√±a "Headers".</li>
                </ul>

                <h2>8Ô∏è‚É£ Por qu√© Basic Auth es inseguro</h2>

                <p><strong>Un senior debe explicar el "por qu√©":</strong></p>

                <ul>
                    <li>‚ùå Base64 no cifra nada</li>
                    <li>‚ùå Credenciales se env√≠an en cada request</li>
                    <li>‚ùå No hay expiraci√≥n</li>
                    <li>‚ùå No hay scopes</li>
                    <li>‚ùå Logout dif√≠cil</li>
                    <li>‚ùå Vulnerable si no usas HTTPS</li>
                </ul>

                <h2>9Ô∏è‚É£ Entonces ¬øpor qu√© aprenderlo?</h2>

                <p>Porque:</p>

                <ul>
                    <li>Es el modelo base mental</li>
                    <li>Te ayuda a entender OAuth</li>
                    <li>Te ayuda a entender JWT</li>
                    <li>Te ayuda a debuggear headers</li>
                    <li>Te hace entender c√≥mo funciona realmente HTTP</li>
                </ul>

                <p><strong>Basic Auth te ense√±a que autenticaci√≥n en HTTP es simplemente:</strong></p>
                <p>Cliente manda prueba ‚Üí Servidor valida ‚Üí Devuelve respuesta</p>

                <h2>üîü Comparaci√≥n con autenticaci√≥n moderna</h2>

                <p><strong>Basic Auth:</strong></p>
                <pre><code>Authorization: Basic base64(user:pass)</code></pre>

                <p><strong>JWT:</strong></p>
                <pre><code>Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...</code></pre>

                <p><strong>La idea es la misma:</strong></p>
                <ul>
                    <li>El cliente env√≠a algo en Authorization</li>
                    <li>El servidor valida</li>
                    <li>Permite o rechaza</li>
                </ul>

                <h2>üß† Mental Model Final</h2>

                <p><strong>HTTP =</strong></p>
                <p>Recibo request ‚Üí Leo headers ‚Üí Decido ‚Üí Fabrico response</p>

                <p><strong>Eso es todo.</strong></p>

                <h2>üéØ Preguntas T√≠picas de Entrevista (con respuestas claras)</h2>

                <p><strong>‚ùì ¬øQu√© es HTTP Basic Authentication?</strong></p>
                <p>Es un mecanismo de autenticaci√≥n donde el cliente env√≠a username y password codificados en Base64 dentro del header Authorization.</p>

                <p><strong>‚ùì ¬øEs Base64 cifrado?</strong></p>
                <p>No. Es encoding, no encryption. Cualquiera puede decodificarlo.</p>

                <p><strong>‚ùì ¬øPor qu√© Basic Auth solo debe usarse con HTTPS?</strong></p>
                <p>Porque las credenciales viajan en cada request y pueden ser interceptadas si no hay TLS.</p>

                <p><strong>‚ùì ¬øCu√°l es la diferencia entre 401 y 403?</strong></p>
                <p>401 ‚Üí No autenticado<br>403 ‚Üí Autenticado pero sin permisos</p>

                <p><strong>‚ùì ¬øQu√© hace el header WWW-Authenticate?</strong></p>
                <p>Le dice al cliente qu√© m√©todo de autenticaci√≥n debe usar. En Basic Auth provoca que el navegador muestre un popup.</p>

                <p><strong>‚ùì ¬øD√≥nde viajan las credenciales en Basic Auth?</strong></p>
                <p>En el header:</p>
                <pre><code>Authorization: Basic &lt;base64&gt;</code></pre>

                <p><strong>‚ùì ¬øCu√°l es el mayor problema de Basic Auth?</strong></p>
                <p>No tiene expiraci√≥n ni scopes, manda credenciales en cada request y depende totalmente de HTTPS para seguridad.</p>

                <p><strong>‚ùì ¬øC√≥mo lo implementar√≠as en Express?</strong></p>
                <p>Como un middleware que inspecciona req.headers.authorization, decodifica, valida y llama a next() o responde 401/403.</p>

                <h2>üöÄ Nivel Senior ‚Äì Respuesta corta tipo entrevista</h2>

                <p>"Basic Auth funciona enviando username y password codificados en Base64 en el header Authorization. El servidor los decodifica y valida. Es inseguro sin HTTPS y no tiene control de expiraci√≥n ni scopes. Es la base conceptual para entender autenticaci√≥n basada en tokens como JWT."</p>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="window.location.href='02-content-negotiation.html'">‚Üê Anterior</button>
                    <button class="btn btn-primary" onclick="window.location.href='../../../index.html'">Volver al Inicio ‚Üí</button>
                </div>
            </section>
        </main>
    </div>

    <script src="../../../assets/js/app.js"></script>
</body>
</html>