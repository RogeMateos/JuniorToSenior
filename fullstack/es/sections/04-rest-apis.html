<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REST APIs | FullStack</title>
    <link rel="stylesheet" href="../../../assets/css/styles.css">
</head>
<body>
    <div class="container">
        <main class="main-content">
            <section id="section-rest-apis">
                <h1>üåê REST APIs y HTTP ‚Äì Fundamentos reales para Full-Stack Engineers</h1>

                <h2>üéØ Objetivos de esta lecci√≥n</h2>

                <p>Al terminar esta p√°gina deber√≠as:</p>
                <ul>
                    <li>Entender claramente d√≥nde termina HTTP y d√≥nde empieza REST</li>
                    <li>Saber explicar REST en una entrevista en 30 segundos</li>
                    <li>Dise√±ar endpoints correctamente (sin "getUsers")</li>
                    <li>Entender stateless, idempotencia, versionado</li>
                    <li>Usar correctamente status codes</li>
                    <li>Documentar una API con OpenAPI/Swagger</li>
                    <li>Pensar como un ingeniero senior, no solo como consumidor de APIs</li>
                </ul>

                <h2>1Ô∏è‚É£ Contexto: El caos antes de REST</h2>

                <p>En los a√±os 2000, durante el boom de internet:</p>
                <ul>
                    <li>Cada empresa dise√±aba su API como quer√≠a</li>
                    <li>URLs tipo: <code>/getUsers</code>, <code>/createUser</code>, <code>/deleteUserNow</code></li>
                    <li>No hab√≠a est√°ndar real</li>
                    <li>No hab√≠a consistencia</li>
                    <li>Escalar era complicado</li>
                </ul>

                <p>Era como conducir en una ciudad sin reglas claras.</p>

                <p><strong>REST aparece para estandarizar c√≥mo dise√±amos APIs sobre HTTP.</strong></p>

                <h2>2Ô∏è‚É£ HTTP vs REST ‚Äì Diferencia cr√≠tica</h2>

                <p><strong>HTTP es:</strong></p>
                <ul>
                    <li>Un protocolo de comunicaci√≥n.</li>
                    <li>Define: M√©todos (GET, POST, PUT, PATCH, DELETE), Headers, Status codes, Caching, Transporte sobre TCP/IP</li>
                </ul>

                <p><strong>REST es:</strong></p>
                <ul>
                    <li>Un estilo arquitect√≥nico que usa HTTP correctamente.</li>
                </ul>

                <p>üëâ <strong>Puedes tener HTTP sin REST.</strong><br>
                üëâ <strong>REST normalmente usa HTTP.</strong></p>

                <h2>3Ô∏è‚É£ Las 6 restricciones REST (nivel senior)</h2>

                <p>REST no es solo "usar GET y POST".</p>

                <p>Tiene 6 principios:</p>

                <p><strong>1. Client‚ÄìServer</strong><br>
                Separaci√≥n clara frontend/backend.</p>

                <p><strong>2. Stateless</strong><br>
                El servidor no guarda estado de sesi√≥n entre requests.</p>

                <p><strong>3. Cacheable</strong><br>
                Las respuestas pueden marcarse como cacheables.</p>

                <p><strong>4. Uniform Interface</strong><br>
                Recursos + verbs consistentes.</p>

                <p><strong>5. Layered System</strong><br>
                Puede haber CDN, gateway, load balancer.</p>

                <p><strong>6. Code on demand (opcional)</strong><br>
                Enviar c√≥digo ejecutable (raro hoy en d√≠a).</p>

                <p>En entrevistas normalmente bastan 3: Stateless, Uniform interface, Cacheable.</p>

                <h2>4Ô∏è‚É£ Stateless ‚Äì Qu√© significa realmente</h2>

                <p>‚ùå No significa que el servidor no tenga variables.<br>
                ‚ùå No significa que no haya base de datos.</p>

                <p>‚úÖ <strong>Significa que el servidor no guarda estado de sesi√≥n del cliente en memoria entre requests.</strong></p>

                <p>Cada request debe traer todo lo necesario:</p>
                <pre><code>GET /users/45
Authorization: Bearer eyJhbGciOi...</code></pre>

                <p>El servidor:</p>
                <ul>
                    <li>Verifica token</li>
                    <li>Consulta base de datos</li>
                    <li>Devuelve respuesta</li>
                    <li>Olvida el request</li>
                </ul>

                <p>Esto permite:</p>
                <ul>
                    <li>Escalar horizontalmente</li>
                    <li>A√±adir m√°s servidores</li>
                    <li>No depender de RAM para sesiones</li>
                </ul>

                <h2>5Ô∏è‚É£ Uniform Interface ‚Äì El coraz√≥n de REST</h2>

                <p><strong>Todo gira alrededor de recursos</strong></p>

                <p>No hacemos:</p>
                <pre><code>POST /createUser
GET /getUsers</code></pre>

                <p>Hacemos:</p>
                <pre><code>GET /users
POST /users
GET /users/{id}
DELETE /users/{id}</code></pre>

                <p><strong>Recursos = Sustantivos<br>
                M√©todos HTTP = Verbos</strong></p>

                <h2>6Ô∏è‚É£ CRUD y HTTP Verbs</h2>

                <table class="cheat-sheet-table">
                    <thead>
                        <tr>
                            <th>Operaci√≥n</th>
                            <th>M√©todo HTTP</th>
                            <th>Idempotente</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Crear</td>
                            <td>POST</td>
                            <td>‚ùå</td>
                        </tr>
                        <tr>
                            <td>Leer</td>
                            <td>GET</td>
                            <td>‚úÖ</td>
                        </tr>
                        <tr>
                            <td>Reemplazar</td>
                            <td>PUT</td>
                            <td>‚úÖ</td>
                        </tr>
                        <tr>
                            <td>Actualizar parcial</td>
                            <td>PATCH</td>
                            <td>‚ö†Ô∏è depende</td>
                        </tr>
                        <tr>
                            <td>Eliminar</td>
                            <td>DELETE</td>
                            <td>‚úÖ</td>
                        </tr>
                    </tbody>
                </table>

                <h2>7Ô∏è‚É£ Idempotencia ‚Äì Explicaci√≥n real</h2>

                <p>Una operaci√≥n es idempotente si: <strong>Repetirla 100 veces deja el sistema en el mismo estado final.</strong></p>

                <p><strong>GET</strong></p>
                <pre><code>GET /users/45</code></pre>
                <p>No modifica nada. Es idempotente. ‚úÖ</p>

                <p><strong>PUT</strong></p>
                <pre><code>PUT /users/45
{
  "name": "Roge",
  "age": 34
}</code></pre>
                <p>Reemplaza el recurso completo. Repetirlo ‚Üí mismo resultado. Idempotente ‚úÖ</p>

                <p><strong>PATCH</strong><br>
                Depende de lo que haga.</p>

                <p>Idempotente:</p>
                <pre><code>PATCH /users/45
{ "name": "Roge" }</code></pre>

                <p>No idempotente:</p>
                <pre><code>PATCH /likes/45
{ "increment": 1 }</code></pre>
                <p>Incrementar 1 varias veces cambia el estado.</p>

                <p><strong>DELETE</strong><br>
                Primera vez: elimina. Segunda vez: ya no existe. El estado final es el mismo. Idempotente ‚úÖ</p>

                <p><strong>POST</strong></p>
                <pre><code>POST /users
{
  "name": "Roge"
}</code></pre>
                <p>Cada request crea un nuevo usuario. No idempotente ‚ùå</p>

                <p>Pero puede hacerse idempotente usando: <code>Idempotency-Key: 1234-abc</code></p>

                <p>Muy usado en pagos.</p>

                <h2>8Ô∏è‚É£ Status Codes Correctos (nivel producci√≥n)</h2>

                <p><strong>GET exitoso</strong><br>
                200 OK</p>

                <p><strong>POST exitoso</strong><br>
                201 Created<br>
                Location: /users/45</p>

                <p><strong>PUT / PATCH exitoso</strong><br>
                200 OK o 204 No Content</p>

                <p><strong>DELETE exitoso</strong><br>
                204 No Content</p>

                <p><strong>Errores importantes</strong></p>
                <table class="cheat-sheet-table">
                    <thead>
                        <tr>
                            <th>C√≥digo</th>
                            <th>Significado</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>400</td>
                            <td>Bad request</td>
                        </tr>
                        <tr>
                            <td>401</td>
                            <td>No autenticado</td>
                        </tr>
                        <tr>
                            <td>403</td>
                            <td>Sin permisos</td>
                        </tr>
                        <tr>
                            <td>404</td>
                            <td>No encontrado</td>
                        </tr>
                        <tr>
                            <td>409</td>
                            <td>Conflicto</td>
                        </tr>
                        <tr>
                            <td>422</td>
                            <td>Error de validaci√≥n</td>
                        </tr>
                        <tr>
                            <td>500</td>
                            <td>Error servidor</td>
                        </tr>
                    </tbody>
                </table>

                <h2>9Ô∏è‚É£ Ejemplo Express Profesional</h2>

                <pre><code>import express from "express";

const app = express();
app.use(express.json());

app.get("/users", async (req, res) => {
  const users = await db.users.findMany();
  res.status(200).json(users);
});

app.post("/users", async (req, res) => {
  const { name, email } = req.body;

  if (!email) {
    return res.status(422).json({
      error: "VALIDATION_ERROR",
      message: "Email is required"
    });
  }

  const user = await db.users.create({ name, email });

  res
    .status(201)
    .set("Location", `/users/${user.id}`)
    .json(user);
});

app.delete("/users/:id", async (req, res) => {
  await db.users.deleteIfExists(req.params.id);
  res.status(204).send();
});</code></pre>

                <h2>üîü Caching en REST</h2>

                <p>REST permite cache.</p>

                <p>Headers importantes:</p>
                <pre><code>Cache-Control: public, max-age=60
ETag: "abc123"</code></pre>

                <p>Revalidaci√≥n:</p>
                <pre><code>If-None-Match: "abc123"</code></pre>

                <p>Respuesta:</p>
                <pre><code>304 Not Modified</code></pre>

                <p><strong>Esto mejora rendimiento y escalabilidad.</strong></p>

                <h2>1Ô∏è‚É£1Ô∏è‚É£ Versionado de APIs</h2>

                <p>Tres formas:</p>

                <p><strong>1. URI Versioning (m√°s com√∫n)</strong></p>
                <pre><code>/v1/users
/v2/users</code></pre>
                <p>‚úîÔ∏è M√°s claro<br>
                ‚úîÔ∏è Mejor para caching</p>

                <p><strong>2. Header Versioning</strong></p>
                <pre><code>API-Version: 2</code></pre>

                <p><strong>3. Query Parameter</strong></p>
                <pre><code>/users?version=2</code></pre>
                <p>Menos recomendado hoy.</p>

                <h2>1Ô∏è‚É£2Ô∏è‚É£ OpenAPI / Swagger</h2>

                <p>Permite documentar la API.</p>

                <p>Debe incluir:</p>
                <ul>
                    <li>Paths</li>
                    <li>M√©todos</li>
                    <li>Params</li>
                    <li>Request body schema</li>
                    <li>Response schema</li>
                    <li>Errores</li>
                    <li>Autenticaci√≥n</li>
                </ul>

                <p>Ejemplo b√°sico:</p>
                <pre><code>paths:
  /users:
    get:
      summary: Get users
      responses:
        200:
          description: OK</code></pre>

                <p>Swagger permite:</p>
                <ul>
                    <li>UI interactiva</li>
                    <li>Generar SDKs</li>
                    <li>Generar mocks</li>
                    <li>Validaci√≥n autom√°tica</li>
                </ul>

                <h2>1Ô∏è‚É£3Ô∏è‚É£ Mental Model Final</h2>

                <p>Cuando un cliente hace un request:</p>

                <ol>
                    <li>DNS resuelve dominio</li>
                    <li>TCP conecta</li>
                    <li>HTTP request viaja</li>
                    <li>API recibe: Method, Path, Headers, Body</li>
                    <li>Backend aplica l√≥gica</li>
                    <li>DB guarda estado</li>
                    <li>Respuesta HTTP vuelve</li>
                </ol>

                <p><strong>REST organiza esta capa API para que:</strong></p>
                <ul>
                    <li>Sea uniforme</li>
                    <li>Sea escalable</li>
                    <li>Sea cacheable</li>
                    <li>Sea mantenible</li>
                </ul>

                <h2>üß† C√≥mo responder en una entrevista</h2>

                <p><strong>"REST es un estilo arquitect√≥nico sobre HTTP que organiza APIs alrededor de recursos, usando una interfaz uniforme. Es stateless, cacheable y favorece escalabilidad. Los m√©todos HTTP se usan para representar operaciones CRUD y deben respetar principios como idempotencia y c√≥digos de estado adecuados."</strong></p>

                <h2>üèÅ Conclusi√≥n</h2>

                <p><strong>REST no es solo "usar GET y POST".</strong></p>

                <p>Es:</p>
                <ul>
                    <li>Dise√±ar bien recursos</li>
                    <li>Pensar en escalabilidad</li>
                    <li>Entender idempotencia</li>
                    <li>Usar status codes correctos</li>
                    <li>Versionar con estrategia</li>
                    <li>Documentar con OpenAPI</li>
                </ul>

                <p><strong>Cuando entiendes esto, dejas de ser consumidor de APIs y empiezas a dise√±arlas correctamente.</strong></p>

                <h2>üìö Referencias y Recursos</h2>

                <p><strong>Para profundizar m√°s:</strong></p>

                <ul>
                    <li><a href="https://chatgpt.com/g/g-p-69925f6597e88191b8bcb93447c5bb78-dragos/c/6994d054-e6ec-8393-97b8-ca40398691bc" target="_blank">Dragos - RESTful API Design & Best Practices</a></li>
                </ul>

                <div class="navigation-buttons">
                    <button class="btn btn-secondary" onclick="window.location.href='03-basic-auth.html'">‚Üê Anterior</button>
                    <button class="btn btn-primary" onclick="window.location.href='../../../index.html'">Volver al Inicio ‚Üí</button>
                </div>
            </section>
        </main>
    </div>

    <script src="../../../assets/js/app.js"></script>
</body>
</html>