<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3.3.1 Diagnosis - Frontend Mastery</title>
    <link rel="stylesheet" href="../../../assets/css/styles.css">
</head>
<body>
    <div class="container">
        <aside id="sidebar" class="sidebar"></aside>
        <main class="main-content">
            <section id="section-diagnosis">
                <h1>üîç Diagn√≥stico Profesional: El Primer Paso</h1>
                <p><strong>Nunca Optimices Lo Que No Has Medido ‚Äî La Mentalidad Senior</strong></p>

                <div class="warning-block" data-title="‚ö†Ô∏è La Verdad Inc√≥moda">
                    <p>Un junior escucha "la app es lenta" y piensa en React.memo.</p>
                    <p>Un senior piensa en diagn√≥stico.</p>
                    <p><strong>Sin diagn√≥stico, cualquier optimizaci√≥n es ruido.</strong></p>
                </div>

                <h2>1Ô∏è‚É£ Mentalidad Senior: Antes de Tocar C√≥digo</h2>

                <div class="concept-block">
                    <p>Antes de abrir DevTools, haz preguntas.</p>
                    <p>Esto no es perder tiempo.</p>
                    <p>Esto es ser profesional.</p>
                </div>

                <h3>Preguntas Clave</h3>

                <div class="solution-block" data-title="üß© Siempre Pregunta Esto">
                    <ul>
                        <li><strong>¬øLenta al cargar o lenta al interactuar?</strong> (La respuesta define todo)</li>
                        <li><strong>¬øEn m√≥vil, desktop o ambos?</strong> (M√≥vil suele ser peor)</li>
                        <li><strong>¬øEn todas las p√°ginas o en algunas?</strong> (Regresi√≥n vs problema cr√≥nico)</li>
                        <li><strong>¬øEs un problema reciente?</strong> (Deploy reciente? Usuario compara con antes?)</li>
                        <li><strong>¬øTenemos m√©tricas reales (RUM)?</strong> (No solo "se siente lenta")</li>
                        <li><strong>¬øQu√© porcentaje de usuarios se ve afectado?</strong> (5% vs 60% = prioridades diferentes)</li>
                    </ul>
                </div>

                <h2>2Ô∏è‚É£ Clasificar el Tipo de Problema</h2>

                <h3>üü¢ Tipo A: Lenta Al Cargar</h3>

                <div class="problem-block" data-title="S√≠ntomas">
                    <ul>
                        <li>Pantalla en blanco mucho tiempo</li>
                        <li>Tarda en mostrarse el contenido</li>
                        <li>Las im√°genes demoran</li>
                    </ul>
                </div>

                <div class="solution-block" data-title="M√©tricas Clave">
                    <ul>
                        <li><strong>LCP</strong> ‚Äî ¬øCu√°ndo aparece el contenido principal?</li>
                        <li><strong>FCP</strong> ‚Äî ¬øCu√°ndo aparece algo visible?</li>
                        <li><strong>CLS</strong> ‚Äî ¬øCu√°nto se mueve la p√°gina al cargar?</li>
                        <li><strong>TTFB</strong> ‚Äî ¬øQu√© tan r√°pido responde el servidor?</li>
                    </ul>
                </div>

                <div class="concept-block">
                    <h4>Causas T√≠picas</h4>
                    <ul>
                        <li>Mucho JavaScript bloqueando</li>
                        <li>Im√°genes sin optimizar</li>
                        <li>CSS bloqueando el render</li>
                        <li>Muchas requests esperando respuesta</li>
                        <li>Servidor lento (TTFB alto)</li>
                    </ul>
                </div>

                <h3>üîµ Tipo B: Lenta Al Interactuar</h3>

                <div class="problem-block" data-title="S√≠ntomas">
                    <ul>
                        <li>Clicks que demoran en responder</li>
                        <li>Scroll con lag / stuttering</li>
                        <li>Inputs lentos para escribir</li>
                        <li>Animaciones entrecortadas</li>
                    </ul>
                </div>

                <div class="solution-block" data-title="M√©tricas Clave">
                    <ul>
                        <li><strong>INP</strong> ‚Äî ¬øCu√°nto tarda en reaccionar tras interactuar?</li>
                        <li><strong>TBT</strong> ‚Äî ¬øCu√°nto JavaScript bloquea el main thread?</li>
                        <li><strong>Long Tasks</strong> ‚Äî ¬øHay tareas > 50ms que bloquean?</li>
                    </ul>
                </div>

                <div class="concept-block">
                    <h4>Causas T√≠picas</h4>
                    <ul>
                        <li>Demasiados re-renders en React</li>
                        <li>C√°lculos costosos sin debounce</li>
                        <li>Listas grandes sin virtualizaci√≥n</li>
                        <li>JavaScript pesado ejecut√°ndose en evento</li>
                        <li>Main thread bloqueado</li>
                    </ul>
                </div>

                <h2>3Ô∏è‚É£ Lighthouse: Diagn√≥stico R√°pido</h2>

                <h3>C√≥mo Ejecutarlo</h3>

                <div class="solution-block" data-title="üíª Pasos">
                    <ol>
                        <li>Abre Chrome</li>
                        <li>Presiona F12 (DevTools)</li>
                        <li>Ve a pesta√±a <strong>Lighthouse</strong></li>
                        <li>Selecciona <strong>Mobile</strong> (m√°s importante)</li>
                        <li>Click en <strong>Analyze page load</strong></li>
                        <li>Espera el resultado</li>
                    </ol>
                </div>

                <div class="warning-block" data-title="‚ö†Ô∏è IMPORTANTE: Usa Inc√≥gnito">
                    <p><strong>Siempre ejecuta en ventana inc√≥gnita.</strong></p>
                    <p>Raz√≥n: Las extensiones de Chrome inyectan scripts que contaminan la medici√≥n.</p>
                    <p>Resultado sin inc√≥gnito: Score falso (puede mostrar 50 en lugar de 85).</p>
                </div>

                <h3>Qu√© Mirar Realmente (No Solo el Score)</h3>

                <div class="concept-block">
                    <p><strong>El score no importa.</strong></p>
                    <p>Importan las m√©tricas reales:</p>
                </div>

                <div class="solution-block" data-title="üéØ Las M√©tricas Que Importan">
                    <ul>
                        <li><strong>LCP:</strong> ¬øEs ‚â§ 2.5s? Si es > 4s, hay problema</li>
                        <li><strong>CLS:</strong> ¬øEs ‚â§ 0.1? Si es > 0.25, hay saltos visibles</li>
                        <li><strong>INP:</strong> ¬øEs ‚â§ 200ms? Si es > 500ms, se siente laggy</li>
                        <li><strong>Render Blocking Resources:</strong> ¬øCu√°les CSS/JS bloquean?</li>
                        <li><strong>Tama√±o de JS:</strong> ¬øCu√°ntos KB en total?</li>
                    </ul>
                </div>

                <div class="interview-block">
                    <div class="interview-title">
                        <span>üß† Mentalidad Correcta Sobre Lighthouse</span>
                        <span class="toggle-arrow">‚ñ∂</span>
                    </div>
                    <div class="interview-content">
                        <p><strong>Lighthouse es laboratorio, no realidad.</strong></p>
                        <p>Se ejecuta en una m√°quina de escritorio potente.</p>
                        <p>Tu usuario real est√° en un iPhone 7 viejo en 4G.</p>
                        <p>Por eso Lighthouse puede mostrar verde y tus usuarios sufrir.</p>
                        <p>Nunca conf√≠es solo en Lighthouse.</p>
                    </div>
                </div>

                <h2>4Ô∏è‚É£ RUM: Real User Monitoring (Lo Real)</h2>

                <div class="warning-block" data-title="‚ö†Ô∏è La Verdad">
                    <p>Lighthouse es simulaci√≥n.</p>
                    <p>RUM es realidad.</p>
                    <p><strong>Siempre elige realidad.</strong></p>
                </div>

                <h3>Qu√© es RUM</h3>

                <div class="concept-block">
                    <p>RUM son herramientas que miden a usuarios reales en producci√≥n:</p>
                    <ul>
                        <li>Sentry</li>
                        <li>Datadog</li>
                        <li>New Relic</li>
                        <li>Google Analytics (Core Web Vitals)</li>
                        <li>Chrome User Experience Report (CrUX)</li>
                    </ul>
                </div>

                <h3>Qu√© Mirar en RUM</h3>

                <div class="solution-block" data-title="üìä M√©tricas Importantes">
                    <ul>
                        <li><strong>P75 (Percentil 75):</strong> El 75% de usuarios experimenta esto o mejor</li>
                        <li><strong>P95 (Percentil 95):</strong> El 5% m√°s lento sufre esto</li>
                        <li><strong>Por dispositivo:</strong> Desktop vs Mobile (probablemente 2-5x diferencia)</li>
                        <li><strong>Por pa√≠s/red:</strong> 4G vs 3G vs WiFi (diferencia masiva)</li>
                        <li><strong>Por ruta:</strong> ¬øCu√°l p√°gina tiene problema?</li>
                    </ul>
                </div>

                <h3>Regla Senior de Oro</h3>

                <div class="problem-block" data-title="‚ùå Forma Incorrecta">
                    <p>Optimizar porque el score de Lighthouse baj√≥ 2 puntos.</p>
                </div>

                <div class="solution-block" data-title="‚úÖ Forma Correcta">
                    <p><strong>Optimizar basado en impacto real:</strong></p>
                    <ul>
                        <li>¬øEl 60% de m√≥vil sufre? ‚Üí URGENTE</li>
                        <li>¬øEl 5% tiene problema? ‚Üí Puedes esperar</li>
                        <li>¬øEl percentil 95 est√° bien? ‚Üí El problema es reciente</li>
                        <li>¬øEl score baj√≥ pero RUM mejor√≥? ‚Üí No toques nada (falsa alarma)</li>
                    </ul>
                </div>

                <h2>5Ô∏è‚É£ Performance Insights: El Oro</h2>

                <div class="concept-block">
                    <p>Performance Insights en DevTools es extremadamente valioso.</p>
                    <p>Aqu√≠ ves exactamente qu√© sucede durante el load.</p>
                </div>

                <h3>C√≥mo Usarlo</h3>

                <div class="solution-block" data-title="üíª Pasos">
                    <ol>
                        <li>DevTools ‚Üí Performance Insights</li>
                        <li>Click <strong>Reload and measure page load</strong></li>
                        <li>Espera</li>
                        <li>Analiza el timeline</li>
                    </ol>
                </div>

                <h3>Qu√© Buscar</h3>

                <div class="solution-block" data-title="üîç Elementos Clave">
                    <ul>
                        <li><strong>First Contentful Paint (FCP):</strong> L√≠nea azul vertical</li>
                        <li><strong>Largest Contentful Paint (LCP):</strong> L√≠nea roja vertical</li>
                        <li><strong>Layout Shift:</strong> Puntos naranja = cambios de layout</li>
                        <li><strong>Long Tasks:</strong> Barras rojas = JavaScript > 50ms bloqueando</li>
                    </ul>
                </div>

                <h3>Ejemplo Real: Diagnosing CLS</h3>

                <div class="analogy-block" data-title="Caso: Imagen que causa Layout Shift">
                    <p><strong>S√≠ntoma:</strong> CLS alto</p>
                    <p><strong>Visualizaci√≥n en Performance Insights:</strong> Ves un punto naranja</p>
                    <p><strong>Causa ra√≠z:</strong> Una imagen sin dimensiones se carga y empuja el contenido</p>
                    <p><strong>Soluci√≥n:</strong> Definir width/height en la imagen</p>
                </div>

                <div class="interview-block">
                    <div class="interview-title">
                        <span>üí° CLS: Antes vs Despu√©s</span>
                        <span class="toggle-arrow">‚ñ∂</span>
                    </div>
                    <div class="interview-content">
                        <h4>Antes (Sin Dimensiones)</h4>
                        <pre><code>&lt;img src="/hero.jpg" /&gt;
&lt;!-- Browser no sabe qu√© espacio reservar --&gt;
&lt;!-- Contenido salta cuando carga la imagen --&gt;</code></pre>

                        <h4>Despu√©s (Con Dimensiones)</h4>
                        <pre><code>&lt;img
  src="/hero.jpg"
  width="1200"
  height="600"
  alt="Hero"
/&gt;
&lt;!-- Layout reservado ‚Üí nada salta --&gt;</code></pre>

                        <p><strong>Resultado:</strong> CLS mejora de 0.3 a 0.02</p>
                    </div>
                </div>

                <h2>6Ô∏è‚É£ Performance Tab (Nivel Avanzado)</h2>

                <div class="warning-block" data-title="‚ö†Ô∏è Herramienta Avanzada">
                    <p>Esta es la m√°s compleja de entender.</p>
                    <p>√ösala solo cuando necesites profundizar.</p>
                </div>

                <h3>Cu√°ndo Usarla</h3>

                <div class="concept-block">
                    <ul>
                        <li>Sabes que hay scripting pesado pero no d√≥nde</li>
                        <li>Necesitas saber exactamente qu√© funci√≥n bloquea</li>
                        <li>Tienes long tasks y necesitas identificarlas</li>
                    </ul>
                </div>

                <h3>Qu√© Buscar</h3>

                <div class="solution-block" data-title="üîé Breakdown de Tiempo">
                    <ul>
                        <li><strong>Scripting:</strong> Si es > 30%, hay JS pesado</li>
                        <li><strong>Rendering:</strong> Si es alto, layout es costoso</li>
                        <li><strong>Painting:</strong> Si es alto, draw es lento</li>
                        <li><strong>Recalculate Style:</strong> CSS muy complejo</li>
                        <li><strong>Long Tasks:</strong> Rojo = bloquea main thread</li>
                    </ul>
                </div>

                <h2>7Ô∏è‚É£ Bundle Analysis: Tree Map</h2>

                <div class="concept-block">
                    <p>Desde Lighthouse puedes analizar exactamente qu√© librer√≠as pesan m√°s.</p>
                    <p>Es crucial para identificar bloat.</p>
                </div>

                <h3>C√≥mo Acceder</h3>

                <div class="solution-block" data-title="üíª En Lighthouse">
                    <ol>
                        <li>Ejecuta an√°lisis de Lighthouse</li>
                        <li>Abajo a la derecha, busca "View original treemap"</li>
                        <li>Se abre treemap mostrando todo el JS</li>
                    </ol>
                </div>

                <h3>Qu√© Interpretar</h3>

                <div class="solution-block" data-title="üß© Lectura Cr√≠tica">
                    <p><strong>Tama√±o = √°rea del rect√°ngulo</strong></p>
                    <p>Un rect√°ngulo gigante = librer√≠a que pesa demasiado</p>
                </div>

                <div class="interview-block">
                    <div class="interview-title">
                        <span>üéØ Ejemplo Real: Identificar Bloat</span>
                        <span class="toggle-arrow">‚ñ∂</span>
                    </div>
                    <div class="interview-content">
                        <p><strong>Escenario:</strong> Ves que Google Tag Manager ocupa el 9% del bundle.</p>
                        <p><strong>Pregunta senior:</strong> ¬øEs necesario cargar en el primer render?</p>
                        <p><strong>Respuesta probablemente:</strong> No. Est√° ah√≠ para analytics.</p>
                        <p><strong>Acci√≥n:</strong> Cargarlo de forma async/defer.</p>
                        <p><strong>Impacto:</strong> LCP mejora significativamente.</p>
                    </div>
                </div>

                <h2>8Ô∏è‚É£ El Playbook Profesional Completo</h2>

                <div class="solution-block" data-title="üîÑ El Flujo de Diagn√≥stico Senior">
                    <ol>
                        <li><strong>Clarificar:</strong> ¬øLoad lento o interaction lento?</li>
                        <li><strong>Lighthouse:</strong> Ejecutar en inc√≥gnito (baseline r√°pido)</li>
                        <li><strong>RUM:</strong> Revisar datos reales (¬øqu√© percentil sufre?)</li>
                        <li><strong>Performance Insights:</strong> Visualizar qu√© sucede</li>
                        <li><strong>Performance Tab:</strong> Si necesitas profundizar (opcional)</li>
                        <li><strong>Bundle Analysis:</strong> Identificar qu√© pesa</li>
                        <li><strong>Priorizar:</strong> ¬øQu√© arreglo da m√°s impacto?</li>
                        <li><strong>Medir:</strong> Antes y despu√©s</li>
                    </ol>
                </div>

                <h2>9Ô∏è‚É£ Errores Comunes de Junior (Que Debes Evitar)</h2>

                <div class="problem-block" data-title="‚ùå Error #1: Optimizar sin medici√≥n">
                    <p>Aplicar useMemo, React.memo, useCallback sin evidencia.</p>
                    <p><strong>Resultado:</strong> M√°s c√≥digo complejo sin beneficio.</p>
                </div>

                <div class="problem-block" data-title="‚ùå Error #2: Confiar solo en Lighthouse">
                    <p>Desktop potente muestra verde. M√≥vil en 4G sufre.</p>
                    <p><strong>Soluci√≥n:</strong> Siempre revisar RUM.</p>
                </div>

                <div class="problem-block" data-title="‚ùå Error #3: Optimizar lo equivocado">
                    <p>LCP lento? ‚Üí Optimizar React cuando el problema es la imagen.</p>
                    <p><strong>Soluci√≥n:</strong> Performance Insights primero.</p>
                </div>

                <div class="problem-block" data-title="‚ùå Error #4: No usar inc√≥gnito">
                    <p>Extensiones de Chrome contaminan medici√≥n.</p>
                    <p><strong>Resultado:</strong> Optimizar problemas falsos.</p>
                </div>

                <h2>üîü Respuesta Senior en Entrevista</h2>

                <div class="interview-block">
                    <div class="interview-title">
                        <span>üé§ "La app es lenta, ¬øqu√© har√≠as?"</span>
                        <span class="toggle-arrow">‚ñ∂</span>
                    </div>
                    <div class="interview-content">
                        <p><strong>Respuesta Senior (modelo):</strong></p>
                        <blockquote>
                            <p>"Primero preguntar√≠a: ¬ølenta al cargar o al interactuar? ¬øEn m√≥vil o desktop? ¬øQu√© porcentaje de usuarios lo reporta?</p>
                            <p>Luego ejecutar√≠a Lighthouse en inc√≥gnito para obtener baseline r√°pido.</p>
                            <p>Revisar√≠a RUM para ver m√©tricas reales en el campo y por qu√© percentil.</p>
                            <p>Usar√≠a Performance Insights para visualizar exactamente qu√© sucede durante el load.</p>
                            <p>Si el problema es LCP, buscar√≠a render-blocking resources. Si es INP, revisar√≠a long tasks en Performance tab.</p>
                            <p>Analizar√≠a el bundle para identificar qu√© librer√≠as pesan m√°s.</p>
                            <p>Luego priorizar√≠a por impacto: servidor, assets, JS, framework tuning ‚Äî en ese orden.</p>
                            <p>Y siempre medir√≠a antes y despu√©s de cada cambio."</p>
                        </blockquote>
                    </div>
                </div>

                <h2>1Ô∏è‚É£1Ô∏è‚É£ Checklist Accionable Ahora Mismo</h2>

                <div class="solution-block" data-title="‚úÖ Haz Esto Hoy">
                    <ol>
                        <li>Abre tu proyecto en Chrome</li>
                        <li>Abre inc√≥gnito (Ctrl+Shift+N)</li>
                        <li>Ve a tu sitio</li>
                        <li>F12 ‚Üí Lighthouse</li>
                        <li>Selecciona Mobile</li>
                        <li>Click Analyze</li>
                        <li>Espera resultado</li>
                        <li>Anota: LCP, CLS, INP, TTFB</li>
                        <li>Identifica el n√∫mero rojo (el peor)</li>
                        <li>Abre Performance Insights</li>
                        <li>Mira el timeline</li>
                        <li>Identifica si es load o interaction</li>
                    </ol>
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-primary" onclick="window.location.href='16-five-steps-web-performance.html'">‚Üê Volver a Los 5 Pasos</button>
                    <button class="btn btn-primary" onclick="window.location.href='../../../index.html'">Volver al Inicio ‚Üí</button>
                </div>
            </section>
        </main>
    </div>

    <script src="../../../assets/js/app.js"></script>
</body>
</html>
