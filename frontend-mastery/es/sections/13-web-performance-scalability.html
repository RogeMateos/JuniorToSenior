<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4. Web Performance & Scalability - Frontend Mastery</title>
    <link rel="stylesheet" href="../../../assets/css/styles.css">
</head>
<body>
    <div class="container">
        <aside id="sidebar" class="sidebar"></aside>
        <main class="main-content">
            <section id="section-web-performance-scalability">
                <h1>ğŸš€ Web Performance & Scalability para Frontend Senior</h1>
                <p><strong>Las Tres MÃ©tricas que Realmente Importan en 2026</strong></p>

                <div class="warning-block" data-title="âš ï¸ Por QuÃ© Importa">
                    <p>Google prioriza Core Web Vitals en los rankings. Todo desarrollador frontend senior debe entender y optimizar estas tres mÃ©tricas. Impactan directamente la satisfacciÃ³n del usuario y las mÃ©tricas de negocio.</p>
                </div>

                <h2>ğŸ¯ Objetivo del Tutorial</h2>
                <p>Al terminar esta guÃ­a sabrÃ¡s:</p>

                <div class="concept-block">
                    <ul>
                        <li>âœ… QuÃ© son las tres Core Web Vitals</li>
                        <li>âœ… Por quÃ© importa cada mÃ©trica</li>
                        <li>âœ… CÃ³mo medirlas correctamente</li>
                        <li>âœ… CÃ³mo optimizar cada una</li>
                        <li>âœ… CÃ³mo prevenir regresiones</li>
                    </ul>
                </div>

                <!-- INTRO: What Are Core Web Vitals -->
                <h2>ğŸ“Š Â¿QuÃ© Son Core Web Vitals?</h2>

                <p>Core Web Vitals son tres mÃ©tricas que miden la experiencia del usuario en tu sitio web:</p>

                <div class="solution-block" data-title="Las Tres Core Web Vitals">
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr style="border-bottom: 1px solid #ddd;">
                            <th style="padding: 10px; text-align: left;">MÃ©trica</th>
                            <th style="padding: 10px; text-align: left;">Mide</th>
                            <th style="padding: 10px; text-align: left;">Bueno âœ…</th>
                            <th style="padding: 10px; text-align: left;">Necesita Mejora âš ï¸</th>
                        </tr>
                        <tr style="border-bottom: 1px solid #ddd;">
                            <td style="padding: 10px;"><strong>LCP</strong></td>
                            <td style="padding: 10px;">Performance de Carga</td>
                            <td style="padding: 10px;">&lt; 2.5s</td>
                            <td style="padding: 10px;">&gt; 4s</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #ddd;">
                            <td style="padding: 10px;"><strong>INP</strong></td>
                            <td style="padding: 10px;">Interactividad</td>
                            <td style="padding: 10px;">&lt; 200ms</td>
                            <td style="padding: 10px;">&gt; 500ms</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px;"><strong>CLS</strong></td>
                            <td style="padding: 10px;">Estabilidad Visual</td>
                            <td style="padding: 10px;">&lt; 0.1</td>
                            <td style="padding: 10px;">&gt; 0.25</td>
                        </tr>
                    </table>
                </div>

                <!-- LCP SECTION -->
                <h2>1ï¸âƒ£ LCP â€” Largest Contentful Paint</h2>

                <h3>Â¿QuÃ© Mide?</h3>

                <div class="concept-block">
                    <p>LCP mide cuÃ¡ndo el <strong>elemento de contenido mÃ¡s grande y visible</strong> aparece en pantalla. Generalmente:</p>
                    <ul>
                        <li>ğŸ“¸ Una imagen hero</li>
                        <li>ğŸ“ Un bloque de texto grande</li>
                        <li>ğŸ¥ Un video</li>
                    </ul>
                </div>

                <div class="analogy-block" data-title="ğŸ§  PiÃ©nsalo Como">
                    <p><strong>"Â¿CuÃ¡ndo ve mi usuario la cosa principal por la que vinieron?"</strong></p>
                    <p>Si un usuario carga tu sitio de e-commerce para ver un producto, LCP mide cuÃ¡ndo ve la imagen del producto. Todo lo demÃ¡s es contexto.</p>
                </div>

                <h3>ğŸ¯ Objetivo: < 2.5 segundos</h3>

                <div class="problem-block" data-title="âš ï¸ Por QuÃ© Importa">
                    <ul>
                        <li>âŒ Los usuarios se van si el contenido tarda &gt; 3 segundos</li>
                        <li>âŒ Google penaliza LCP lento en rankings</li>
                        <li>âŒ Los usuarios mÃ³viles son especialmente sensibles (tienen redes mÃ¡s lentas)</li>
                    </ul>
                </div>

                <h3>CÃ³mo Optimizar LCP</h3>

                <h4>ğŸ”´ Problema: ImÃ¡genes grandes sin optimizar</h4>

                <div class="problem-block" data-title="âŒ Mal">
<pre><code>&lt;img src="/hero.jpg" alt="Hero" /&gt;
&lt;!-- 5MB image, sin optimizaciÃ³n --&gt;</code></pre>
                </div>

                <div class="solution-block" data-title="âœ… Bien">
<pre><code>&lt;img
  src="/hero.webp"
  alt="Hero"
  width="1200"
  height="600"
  fetchpriority="high"
  loading="eager"
/&gt;
&lt;!-- Formato WebP (mÃ¡s pequeÃ±o), dimensiones especificadas, alta prioridad --&gt;</code></pre>
                </div>

                <h4>ğŸ”´ Problema: CSS bloqueando renderizado</h4>

                <div class="problem-block" data-title="âŒ Mal">
<pre><code>&lt;link rel="stylesheet" href="styles.css"&gt;
&lt;!-- La pÃ¡gina espera TODO el CSS antes de renderizar --&gt;</code></pre>
                </div>

                <div class="solution-block" data-title="âœ… Bien">
<pre><code>&lt;!-- CSS crÃ­tico inline --&gt;
&lt;style&gt;
  body { font-family: system-ui; }
  .hero { display: flex; ... }
&lt;/style&gt;

&lt;!-- Resto diferido --&gt;
&lt;link rel="stylesheet" href="rest.css" media="print" onload="this.media='all'"&gt;</code></pre>
                </div>

                <h4>ğŸ”´ Problema: JavaScript enorme bloqueando renderizado</h4>

                <div class="problem-block" data-title="âŒ Mal">
<pre><code>&lt;script src="app-bundle-2.5MB.js"&gt;&lt;/script&gt;
&lt;!-- Navegador bloquea renderizado hasta que JS se parsea y ejecuta --&gt;</code></pre>
                </div>

                <div class="solution-block" data-title="âœ… Bien">
<pre><code>&lt;!-- Difiere JS no crÃ­tico --&gt;
&lt;script defer src="app.js"&gt;&lt;/script&gt;

&lt;!-- Usa code splitting --&gt;
&lt;script type="module"&gt;
  import { lazy, Suspense } from 'react';
  const HeavyComponent = lazy(() => import('./HeavyComponent'));
&lt;/script&gt;</code></pre>
                </div>

                <!-- INP SECTION -->
                <h2>2ï¸âƒ£ INP â€” Interaction to Next Paint</h2>

                <h3>Â¿QuÃ© Mide?</h3>

                <div class="concept-block">
                    <p>INP mide quÃ© tan rÃ¡pido responde tu pÃ¡gina a interacciones del usuario. Cuando un usuario:</p>
                    <ul>
                        <li>ğŸ–±ï¸ Hace clic en un botÃ³n</li>
                        <li>âŒ¨ï¸ Escribe en un campo</li>
                        <li>ğŸ‘† Toca en mÃ³vil</li>
                    </ul>
                    <p>Â¿CuÃ¡nto tiempo hasta que vea retroalimentaciÃ³n visual?</p>
                </div>

                <div class="analogy-block" data-title="ğŸ§  PiÃ©nsalo Como">
                    <p><strong>"Â¿Se siente mi sitio receptivo?"</strong></p>
                    <p>Una respuesta de 50ms se siente instantÃ¡nea. Una de 500ms se siente lenta. Los usuarios toleran hasta 200ms.</p>
                </div>

                <h3>ğŸ¯ Objetivo: < 200 milisegundos</h3>

                <div class="problem-block" data-title="âš ï¸ Por QuÃ© Importa">
                    <ul>
                        <li>âŒ Los sitios lentos se sienten rotos</li>
                        <li>âŒ Los usuarios abandonan formularios que no responden</li>
                        <li>âŒ Impacta directamente tasas de conversiÃ³n</li>
                        <li>âŒ Google ahora usa INP en algoritmo de ranking</li>
                    </ul>
                </div>

                <h3>CÃ³mo Optimizar INP</h3>

                <h4>ğŸ”´ Problema: JavaScript pesado bloqueando en interacciÃ³n</h4>

                <div class="problem-block" data-title="âŒ Mal - Click en BotÃ³n Lentea">
<pre><code>button.addEventListener('click', () => {
  // Haz trabajo masivo sincronamente
  for (let i = 0; i < 1000000; i++) {
    expensiveCalculation();
  }
  // Usuario espera 500ms a ver algo
  updateUI();
});</code></pre>
                </div>

                <div class="solution-block" data-title="âœ… Bien - Responde RÃ¡pido">
<pre><code>button.addEventListener('click', async () => {
  // Muestra retroalimentaciÃ³n inmediatamente
  button.disabled = true;
  button.textContent = 'Procesando...';

  // Haz trabajo pesado fuera del main thread
  const result = await new Worker('worker.js')
    .postMessage(data);

  updateUI(result);
});</code></pre>
                </div>

                <h4>ğŸ”´ Problema: Re-renders innecesarios en React</h4>

                <div class="problem-block" data-title="âŒ Mal - Click en Input Re-renderiza Toda la Lista">
<pre><code>function ProductFilter() {
  const [search, setSearch] = useState('');

  return (
    &lt;&gt;
      &lt;input onChange={e => setSearch(e.target.value)} /&gt;
      &lt;ProductList products={products} /&gt;
      &lt;!-- ProductList se re-renderiza en cada keystroke --&gt;
    &lt;/&gt;
  );
}</code></pre>
                </div>

                <div class="solution-block" data-title="âœ… Bien - Memoriza Lista">
<pre><code>const ProductList = memo(function ProductList({ products }) {
  return &lt;div&gt;...&lt;/div&gt;;
});

function ProductFilter() {
  const [search, setSearch] = useState('');

  return (
    &lt;&gt;
      &lt;input onChange={e => setSearch(e.target.value)} /&gt;
      &lt;ProductList products={products} /&gt;
      &lt;!-- ProductList no se re-renderiza si products no cambian --&gt;
    &lt;/&gt;
  );
}</code></pre>
                </div>

                <h4>ğŸ”´ Problema: Tareas de larga duraciÃ³n en main thread</h4>

                <div class="solution-block" data-title="ğŸ’¡ Usa startTransition para actualizaciones no urgentes">
<pre><code>import { startTransition } from 'react';

function SearchPage() {
  const [results, setResults] = useState([]);

  const handleSearch = (query) => {
    // Muestra cambio de input inmediatamente
    // Pero difiere actualizaciÃ³n de resultados si es cara
    startTransition(() => {
      setResults(expensiveSearch(query));
    });
  };
}</code></pre>
                </div>

                <!-- CLS SECTION -->
                <h2>3ï¸âƒ£ CLS â€” Cumulative Layout Shift</h2>

                <h3>Â¿QuÃ© Mide?</h3>

                <div class="concept-block">
                    <p>CLS mide cuÃ¡nto el layout <strong>se desplaza inesperadamente</strong> mientras la pÃ¡gina carga. Ejemplos:</p>
                    <ul>
                        <li>âŒ Una imagen carga y empuja texto hacia abajo</li>
                        <li>âŒ Un banner de anuncio aparece y desplaza contenido</li>
                        <li>âŒ Una fuente carga y el texto se reajusta</li>
                        <li>âŒ Un modal se abre y la pÃ¡gina salta</li>
                    </ul>
                </div>

                <div class="analogy-block" data-title="ğŸ§  PiÃ©nsalo Como">
                    <p><strong>"Â¿Se mueve la pÃ¡gina mientras intento leerla?"</strong></p>
                    <p>Imagina leer un artÃ­culo y de repente se desplaza hacia abajo porque una imagen cargÃ³. Frustrante, Â¿verdad? Eso es CLS.</p>
                </div>

                <h3>ğŸ¯ Objetivo: < 0.1</h3>

                <div class="problem-block" data-title="âš ï¸ Por QuÃ© Importa">
                    <ul>
                        <li>âŒ Los usuarios hacen clic en la cosa equivocada si el layout se desplaza (clics accidentales)</li>
                        <li>âŒ Se siente poco profesional</li>
                        <li>âŒ Impacta directamente la calidad de experiencia</li>
                        <li>âŒ Google penaliza en rankings</li>
                    </ul>
                </div>

                <h3>CÃ³mo Optimizar CLS</h3>

                <h4>ğŸ”´ Problema: ImÃ¡genes sin dimensiones</h4>

                <div class="problem-block" data-title="âŒ Mal - Layout se Desplaza Cuando Imagen Carga">
<pre><code>&lt;img src="/photo.jpg" alt="Foto" /&gt;
&lt;!-- El navegador no conoce el tamaÃ±o hasta que descarga comienza
     La pÃ¡gina se desplaza cuando la imagen llega --&gt;</code></pre>
                </div>

                <div class="solution-block" data-title="âœ… Bien - Reserva Espacio">
<pre><code>&lt;img
  src="/photo.jpg"
  alt="Foto"
  width="600"
  height="400"
/&gt;
&lt;!-- Navegador reserva espacio inmediatamente --&gt;</code></pre>
                </div>

                <h4>ğŸ”´ Problema: Fuentes cargando y reajustÃ¡ndose</h4>

                <div class="problem-block" data-title="âŒ Mal - Texto se Reajusta Cuando Fuente Carga">
<pre><code>@font-face {
  font-family: 'CustomFont';
  src: url('/font.woff2');
}
/* El navegador renderiza fallback, luego cambia a fuente personalizada
   El texto se reajusta y se desplaza */</code></pre>
                </div>

                <div class="solution-block" data-title="âœ… Bien - Usa font-display: swap">
<pre><code>@font-face {
  font-family: 'CustomFont';
  src: url('/font.woff2');
  font-display: swap;
}
/* El navegador muestra fallback inmediatamente
   Cambia a fuente personalizada cuando estÃ¡ lista (desplazamiento mÃ­nimo) */</code></pre>
                </div>

                <h4>ğŸ”´ Problema: Anuncios y banners cargando sin espacio reservado</h4>

                <div class="problem-block" data-title="âŒ Mal - Banner Aparece y Desplaza Contenido">
<pre><code>&lt;div id="ad-container"&gt;&lt;/div&gt;
&lt;!-- Anuncio carga asincrÃ³nicamente y desplaza todo --&gt;</code></pre>
                </div>

                <div class="solution-block" data-title="âœ… Bien - Reserva Espacio">
<pre><code>&lt;div id="ad-container" style="height: 250px; width: 300px;"&gt;
  &lt;!-- Reserva 250px x 300px para anuncio --&gt;
&lt;/div&gt;
&lt;!-- Anuncio carga pero no desplaza layout --&gt;</code></pre>
                </div>

                <!-- MEASURING SECTION -->
                <h2>ğŸ“ CÃ³mo Medir Core Web Vitals</h2>

                <h3>OpciÃ³n 1: Lighthouse (Desarrollo)</h3>

                <div class="concept-block">
                    <ol>
                        <li>Abre Chrome DevTools (F12)</li>
                        <li>Ve a la pestaÃ±a "Lighthouse"</li>
                        <li>Haz clic en "Analyze page load"</li>
                        <li>Espera los resultados</li>
                    </ol>
                </div>

                <div class="warning-block" data-title="âš ï¸ Importante">
                    <p>Lighthouse usa <strong>condiciones simuladas</strong> (4G lento, CPU limitada). Los usuarios reales tienen condiciones diferentes. Ãšsalo para diagnÃ³stico, no como la Ãºnica mÃ©trica.</p>
                </div>

                <h3>OpciÃ³n 2: LibrerÃ­a Web Vitals (ProducciÃ³n)</h3>

                <div class="solution-block" data-title="ğŸ’» Rastrear Core Web Vitals en ProducciÃ³n">
<pre><code>import { getCLS, getLCP, getINP } from 'web-vitals';

getCLS(console.log); // Valor CLS
getLCP(console.log); // Valor LCP
getINP(console.log); // Valor INP

// EnvÃ­a a analytics
getCLS((metric) => {
  fetch('/analytics', {
    method: 'POST',
    body: JSON.stringify(metric)
  });
});</code></pre>
                </div>

                <h3>OpciÃ³n 3: Chrome DevTools Performance Tab</h3>

                <div class="concept-block">
                    <ol>
                        <li>Abre DevTools</li>
                        <li>Ve a la pestaÃ±a "Performance"</li>
                        <li>Haz clic en el botÃ³n de grabar</li>
                        <li>InteractÃºa con la pÃ¡gina (scroll, clic, escribe)</li>
                        <li>Para la grabaciÃ³n</li>
                        <li>Busca marcadores de Core Web Vitals</li>
                    </ol>
                </div>

                <!-- AUDIT CHECKLIST -->
                <h2>âœ… Checklist de AuditorÃ­a de Core Web Vitals</h2>

                <h3>Para LCP</h3>
                <div class="concept-block">
                    <ul>
                        <li>â“ Â¿EstÃ¡ optimizada la imagen hero (WebP, comprimida)?</li>
                        <li>â“ Â¿EstÃ¡ precargada la imagen hero?</li>
                        <li>â“ Â¿CSS no bloquea renderizado?</li>
                        <li>â“ Â¿JavaScript estÃ¡ diferido o async?</li>
                        <li>â“ Â¿Es rÃ¡pido el tiempo de respuesta del servidor (&lt;600ms)?</li>
                    </ul>
                </div>

                <h3>Para INP</h3>
                <div class="concept-block">
                    <ul>
                        <li>â“ Â¿Son rÃ¡pidos los event handlers (&lt;100ms)?</li>
                        <li>â“ Â¿Se eliminan re-renders innecesarios?</li>
                        <li>â“ Â¿Se rompen las tareas largas en trozos mÃ¡s pequeÃ±os?</li>
                        <li>â“ Â¿Se offloadea trabajo pesado a Web Workers?</li>
                        <li>â“ Â¿Se usa React.memo/useMemo estratÃ©gicamente?</li>
                    </ul>
                </div>

                <h3>Para CLS</h3>
                <div class="concept-block">
                    <ul>
                        <li>â“ Â¿Tienen todas las imÃ¡genes atributos width/height?</li>
                        <li>â“ Â¿Usan las fuentes web font-display: swap?</li>
                        <li>â“ Â¿Se reserva espacio para anuncios/banners?</li>
                        <li>â“ Â¿Tienen modales/overlays posicionamiento fijo?</li>
                        <li>â“ Â¿Se da altura a secciones de contenido dinÃ¡mico?</li>
                    </ul>
                </div>

                <!-- FINAL MINDSET -->
                <h2>ğŸ¯ La Mentalidad Senior</h2>

                <div class="solution-block" data-title="ğŸ¯ Recuerda">
                    <ul>
                        <li>âœ… <strong>Mide primero.</strong> No puedes mejorar lo que no mides.</li>
                        <li>âœ… <strong>Optimiza para usuarios reales.</strong> No solo para puntuaciones de Lighthouse.</li>
                        <li>âœ… <strong>Piensa holÃ­sticamente.</strong> Optimiza las tres mÃ©tricas, no solo una.</li>
                        <li>âœ… <strong>Previene regresiones.</strong> Usa performance budgets y monitoreo.</li>
                        <li>âœ… <strong>Equilibra performance y features.</strong> Elige quÃ© importa para tu negocio.</li>
                    </ul>
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-primary" onclick="window.location.href='12-summary.html'">â† Anterior</button>
                    <button class="btn btn-primary" onclick="window.location.href='../../../index.html'">Volver al Inicio â†’</button>
                </div>
            </section>
        </main>
    </div>

    <script src="../../../assets/js/app.js"></script>
</body>
</html>
