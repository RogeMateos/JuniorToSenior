<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5. The Core Web Vitals - Frontend Mastery</title>
    <link rel="stylesheet" href="../../../assets/css/styles.css">
</head>
<body>
    <div class="container">
        <main class="main-content">
            <section id="section-core-web-vitals">
                <h1>üöÄ Web Performance & Core Web Vitals ‚Äî Gu√≠a Completa</h1>

                <h2>1Ô∏è‚É£ Primero: ¬øQu√© es Realmente Performance?</h2>

                <p>Como senior te lo resumo as√≠:</p>

                <div class="warning-block" data-title="‚ö†Ô∏è Concepto Clave">
                    <p><strong>Performance no es velocidad t√©cnica. Performance es percepci√≥n del usuario.</strong></p>
                </div>

                <p>Una web se siente r√°pida cuando:</p>

                <div class="concept-block">
                    <ul>
                        <li>‚úÖ Algo aparece r√°pido</li>
                        <li>‚úÖ Responde inmediatamente al interactuar</li>
                        <li>‚úÖ No se mueve inesperadamente</li>
                    </ul>
                </div>

                <p>Si falla uno de esos tres, el usuario percibe que es lenta.</p>

                <h2>2Ô∏è‚É£ Modelo Mental: Los 3 Pilares</h2>

                <div class="analogy-block" data-title="üü¢ Los Tres Pilares del Performance">
                    <ol>
                        <li><strong>Perceived Load Speed</strong> ‚Äî ¬øCu√°ndo veo algo √∫til en pantalla?</li>
                        <li><strong>Responsiveness</strong> ‚Äî ¬øResponde r√°pido cuando hago click o escribo?</li>
                        <li><strong>Visual Stability</strong> ‚Äî ¬øSe mueve el layout mientras carga?</li>
                    </ol>
                </div>

                <p>Estos 3 pilares se traducen en m√©tricas.</p>

                <h2>3Ô∏è‚É£ Core Web Vitals (Las M√©tricas que Importan)</h2>

                <h3>üü¢ LCP ‚Äî Largest Contentful Paint</h3>

                <div class="concept-block">
                    <p>Mide cu√°ndo aparece el elemento principal visible.</p>
                    <ul>
                        <li>üìå Bueno: ‚â§ 2.5 segundos</li>
                        <li>üìå Malo: > 4 segundos</li>
                    </ul>
                </div>

                <div class="solution-block" data-title="Causas T√≠picas de LCP Alto">
                    <ul>
                        <li>Imagen hero pesada</li>
                        <li>CSS bloqueando render</li>
                        <li>JavaScript bloqueando main thread</li>
                        <li>Servidor lento (TTFB alto)</li>
                    </ul>
                </div>

                <h3>üü¢ INP ‚Äî Interaction to Next Paint</h3>

                <div class="concept-block">
                    <p>Mide cu√°nto tarda la interfaz en reaccionar visualmente tras una interacci√≥n.</p>
                    <ul>
                        <li>üìå Bueno: ‚â§ 200ms</li>
                        <li>üìå Malo: > 500ms</li>
                    </ul>
                </div>

                <div class="solution-block" data-title="Causas T√≠picas de INP Alto">
                    <ul>
                        <li>JavaScript pesado</li>
                        <li>Re-renders innecesarios</li>
                        <li>C√°lculos sin debounce</li>
                        <li>Bundle muy grande</li>
                    </ul>
                </div>

                <h3>üü¢ CLS ‚Äî Cumulative Layout Shift</h3>

                <div class="concept-block">
                    <p>Mide cu√°nto se mueve el layout mientras carga.</p>
                    <ul>
                        <li>üìå Bueno: ‚â§ 0.1</li>
                        <li>üìå Malo: > 0.25</li>
                    </ul>
                </div>

                <div class="solution-block" data-title="Causas T√≠picas de CLS Alto">
                    <ul>
                        <li>Im√°genes sin dimensiones</li>
                        <li>Fuentes que cambian tama√±o</li>
                        <li>Elementos que aparecen empujando contenido</li>
                        <li>Anuncios cargando sin espacio reservado</li>
                    </ul>
                </div>

                <h2>4Ô∏è‚É£ Importante: Core Web Vitals ‚â† Todas las M√©tricas de Lighthouse</h2>

                <div class="analogy-block" data-title="üîç Qu√© es Realmente Core Web Vitals">
                    <p><strong>Core Web Vitals reales:</strong></p>
                    <ul>
                        <li>‚úÖ LCP</li>
                        <li>‚úÖ INP</li>
                        <li>‚úÖ CLS</li>
                    </ul>
                </div>

                <div class="concept-block">
                    <p><strong>Lighthouse tambi√©n muestra (pero no son Core Web Vitals):</strong></p>
                    <ul>
                        <li>FCP (First Contentful Paint)</li>
                        <li>TBT (Total Blocking Time)</li>
                        <li>Speed Index</li>
                    </ul>
                </div>

                <div class="problem-block" data-title="Senior Tip">
                    <p>TBT suele correlacionar con problemas de INP.</p>
                </div>

                <h2>5Ô∏è‚É£ Lab vs Field (Error T√≠pico de Juniors)</h2>

                <div class="warning-block" data-title="‚ö†Ô∏è No Confundas Estos">
                    <p><strong>Lab Data:</strong> Lighthouse, DevTools (simulaci√≥n)</p>
                    <p><strong>Field Data:</strong> Sentry, CrUX, RUM tools (usuarios reales)</p>
                </div>

                <div class="problem-block" data-title="‚ùå Error Com√∫n">
                    <p>Tu MacBook Pro no representa un Android barato en 3G.</p>
                </div>

                <h2>6Ô∏è‚É£ C√≥mo Analizar un Reporte Correctamente (Mentalidad Senior)</h2>

                <div class="solution-block" data-title="Flujo Profesional">
                    <ol>
                        <li>Ejecuta Lighthouse</li>
                        <li>Mira cu√°l m√©trica est√° peor</li>
                        <li>Ve a "Opportunities"</li>
                        <li>Elige m√°ximo 3 mejoras</li>
                        <li>Cambia UNA sola cosa</li>
                        <li>Vuelve a medir</li>
                    </ol>
                </div>

                <p>Nunca optimices todo a la vez.</p>

                <h2>7Ô∏è‚É£ Ejemplos Pr√°cticos Reales</h2>

                <h3>üîß Ejemplo 1 ‚Äî Arreglar CLS</h3>

                <div class="problem-block" data-title="‚ùå Mal">
<pre><code>&lt;img src="/hero.jpg" /&gt;
&lt;!-- El navegador no sabe cu√°nto espacio reservar --&gt;</code></pre>
                </div>

                <div class="solution-block" data-title="‚úÖ Correcto">
<pre><code>&lt;img
  src="/hero.jpg"
  width="1200"
  height="600"
  alt="Hero"
/&gt;
&lt;!-- Ahora el layout no salta --&gt;</code></pre>
                </div>

                <p>En React:</p>

                <div class="solution-block" data-title="üíª Ejemplo React">
<pre><code>&lt;img
  src="/hero.jpg"
  width={1200}
  height={600}
  alt="Hero"
/&gt;</code></pre>
                </div>

                <h3>üîß Ejemplo 2 ‚Äî Reducir INP (Debounce)</h3>

                <div class="problem-block" data-title="‚ùå Mal">
<pre><code>input.addEventListener("input", (e) => {
  expensiveSearch(e.target.value);
});
// Se ejecuta en cada tecla</code></pre>
                </div>

                <div class="solution-block" data-title="‚úÖ Mejor">
<pre><code>function debounce(fn, delay = 250) {
  let timeout;
  return (...args) => {
    clearTimeout(timeout);
    timeout = setTimeout(() => fn(...args), delay);
  };
}

const handleSearch = debounce((value) => {
  expensiveSearch(value);
}, 300);

input.addEventListener("input", (e) => {
  handleSearch(e.target.value);
});
// Ahora reduces carga en main thread</code></pre>
                </div>

                <h3>üîß Ejemplo 3 ‚Äî Mejorar LCP (Optimizar Imagen Hero)</h3>

                <div class="problem-block" data-title="‚ùå 3MB JPG sin optimizar">
<pre><code>&lt;img src="/hero.jpg" /&gt;</code></pre>
                </div>

                <div class="solution-block" data-title="‚úÖ Optimizado">
<pre><code>&lt;img
  src="/hero.webp"
  width="1200"
  height="600"
  loading="eager"
  alt="Hero"
/&gt;
&lt;!-- Convertir a WebP, comprimir, especificar dimensiones --&gt;</code></pre>
                </div>

                <p>Para im√°genes no visibles inicialmente:</p>

                <div class="solution-block" data-title="üíª Ejemplo Lazy Load">
<pre><code>&lt;img
  src="/gallery.webp"
  width="400"
  height="300"
  loading="lazy"
  alt="Galer√≠a"
/&gt;</code></pre>
                </div>

                <h2>8Ô∏è‚É£ Main Thread ‚Äî Concepto Clave</h2>

                <div class="warning-block" data-title="‚ö†Ô∏è El Navegador Tiene Un Hilo Principal">
                    <p>Si ejecutas mucho JavaScript, bloqueas:</p>
                    <ul>
                        <li>Clicks</li>
                        <li>Scroll</li>
                        <li>Animaciones</li>
                        <li>Input</li>
                    </ul>
                </div>

                <p>Si una tarea dura m√°s de 50ms, se considera Long Task.</p>

                <div class="problem-block" data-title="‚ùå Ejemplo de Bloqueo">
<pre><code>const start = Date.now();

while (Date.now() - start < 300) {
  // bloquea 300ms
}
// Esto rompe INP</code></pre>
                </div>

                <h2>9Ô∏è‚É£ Reducir JavaScript Innecesario</h2>

                <div class="solution-block" data-title="Code Splitting">
<pre><code>import("./heavyModule").then((module) => {
  module.run();
});</code></pre>
                </div>

                <p>En React:</p>

                <div class="solution-block" data-title="üíª Code Splitting en React">
<pre><code>const HeavyComponent = React.lazy(() =>
  import("./HeavyComponent")
);

// Carga solo cuando es necesario</code></pre>
                </div>

                <h2>üîü Flujo Profesional</h2>

                <div class="solution-block" data-title="Siempre Sigue Esto">
                    <p><strong>Measure ‚Üí Improve ‚Üí Measure Again</strong></p>
                </div>

                <div class="concept-block">
                    <h4>Checklist Real:</h4>
                    <ul>
                        <li>‚ùì ¬øEst√° optimizada la imagen hero?</li>
                        <li>‚ùì ¬øSe redujo JS?</li>
                        <li>‚ùì ¬øTienen dimensiones las im√°genes?</li>
                        <li>‚ùì ¬øEst√° activado lazy loading?</li>
                        <li>‚ùì ¬øEst√° minificado el CSS?</li>
                        <li>‚ùì ¬øSe evitan re-renders innecesarios?</li>
                    </ul>
                </div>

                <!-- ACCORDION SECTION -->
                <h2>üìã Tips y Trucos Adicionales</h2>

                <div class="interview-block">
                    <div class="interview-title">
                        <span>üí° T√©cnicas Avanzadas de Optimizaci√≥n</span>
                        <span class="toggle-arrow">‚ñ∂</span>
                    </div>
                    <div class="interview-content">
                        <h4>1. Preload Recursos Cr√≠ticos</h4>
                        <pre><code>&lt;link rel="preload" as="image" href="/hero.webp"&gt;
&lt;link rel="preload" as="font" href="/font.woff2"&gt;</code></pre>

                        <h4>2. Usa Service Workers para Caching</h4>
                        <pre><code>if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/sw.js');
}</code></pre>

                        <h4>3. Comprime Im√°genes con Formatos Modernos</h4>
                        <pre><code>&lt;picture&gt;
  &lt;source srcset="/image.avif" type="image/avif"&gt;
  &lt;source srcset="/image.webp" type="image/webp"&gt;
  &lt;img src="/image.jpg" alt="Fallback"&gt;
&lt;/picture&gt;</code></pre>

                        <h4>4. Implementa Critical CSS Inlining</h4>
                        <pre><code>&lt;style&gt;
  /* CSS cr√≠tico inline - solo above-the-fold */
  .hero { display: flex; ... }
&lt;/style&gt;
&lt;link rel="stylesheet" href="rest.css"&gt;</code></pre>

                        <h4>5. Usa requestAnimationFrame para Actualizaciones Suaves</h4>
                        <pre><code>function updateDOM() {
  requestAnimationFrame(() => {
    // Actualizaciones del DOM aqu√≠
  });
}</code></pre>

                        <h4>6. Implementa Resource Hints</h4>
                        <pre><code>&lt;link rel="dns-prefetch" href="//cdn.example.com"&gt;
&lt;link rel="preconnect" href="//api.example.com"&gt;
&lt;link rel="prefetch" href="/next-page.html"&gt;</code></pre>
                    </div>
                </div>

                <div class="interview-block">
                    <div class="interview-title">
                        <span>üöÄ Action Item para Tu Proyecto Real</span>
                        <span class="toggle-arrow">‚ñ∂</span>
                    </div>
                    <div class="interview-content">
                        <ol>
                            <li><strong>Ejecuta Lighthouse en modo Mobile</strong></li>
                            <li><strong>Anota:</strong>
                                <ul>
                                    <li>LCP</li>
                                    <li>INP (o TBT si INP no aparece)</li>
                                    <li>CLS</li>
                                </ul>
                            </li>
                            <li><strong>Elige 3 mejoras de Opportunities</strong></li>
                            <li><strong>Aplica 1 optimizaci√≥n</strong></li>
                            <li><strong>Vuelve a medir</strong></li>
                            <li><strong>Repite 3 veces</strong></li>
                        </ol>
                        <p><strong>Te prometo que aprender√°s m√°s que viendo 10 v√≠deos.</strong></p>
                    </div>
                </div>

                <div class="interview-block">
                    <div class="interview-title">
                        <span>üß† Resumen para Entrevista</span>
                        <span class="toggle-arrow">‚ñ∂</span>
                    </div>
                    <div class="interview-content">
                        <p><strong>Si ma√±ana te preguntan: "¬øQu√© son Core Web Vitals?"</strong></p>
                        <p><strong>Respuesta senior corta:</strong></p>
                        <blockquote>
                            <p>"Son m√©tricas que miden la experiencia real del usuario.</p>
                            <p>LCP mide carga percibida.</p>
                            <p>INP mide capacidad de respuesta.</p>
                            <p>CLS mide estabilidad visual.</p>
                            <p>Lighthouse es lab, RUM es field.</p>
                            <p>El main thread es el cuello de botella."</p>
                        </blockquote>
                    </div>
                </div>

                <!-- REFERENCES SECTION -->
                <h2>üìö Referencias y Recursos Adicionales</h2>

                <div class="solution-block" data-title="Documentaci√≥n Oficial">
                    <ul>
                        <li><a href="https://web.dev/vitals/" target="_blank">Google Web Vitals Documentation</a></li>
                        <li><a href="https://developer.mozilla.org/en-US/docs/Glossary/Core_Web_Vitals" target="_blank">MDN: Core Web Vitals</a></li>
                        <li><a href="https://web.dev/lighthouse/" target="_blank">Google Lighthouse Guide</a></li>
                    </ul>
                </div>

                <div class="concept-block">
                    <h4>Herramientas √ötiles</h4>
                    <ul>
                        <li><a href="https://developers.google.com/speed/pagespeed/insights" target="_blank">PageSpeed Insights</a></li>
                        <li><a href="https://www.webpagetest.org/" target="_blank">WebPageTest</a></li>
                        <li><a href="https://github.com/GoogleChrome/web-vitals" target="_blank">Web Vitals JavaScript Library</a></li>
                    </ul>
                </div>

                <div class="analogy-block" data-title="Recursos de Aprendizaje">
                    <ul>
                        <li><a href="https://web.dev/" target="_blank">web.dev ‚Äî Google's Web Performance Hub</a></li>
                        <li><a href="https://developers.google.com/speed" target="_blank">Google Speed Documentation</a></li>
                        <li><a href="https://www.smashingmagazine.com/" target="_blank">Smashing Magazine ‚Äî Performance Articles</a></li>
                    </ul>
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-primary" onclick="window.location.href='13-web-performance-scalability.html'">‚Üê Anterior</button>
                    <button class="btn btn-primary" onclick="window.location.href='../../../index.html'">Volver al Inicio ‚Üí</button>
                </div>
            </section>
        </main>
    </div>

    <script src="../../../assets/js/app.js"></script>
</body>
</html>
